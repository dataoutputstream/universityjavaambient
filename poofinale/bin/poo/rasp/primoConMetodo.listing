1: ;legge un intero, e scrive -1 se non positivo, 1 se è primo, 0 se non primo
2: ;usa un metodo di appoggio
3: STACK:	RES	100
4: 	LOAD#	0
5: 	STORE	SS ; Stack Size - punta al primo libero dello stack
6: 	READ	NUM
7: 	LOAD	NUM
8: 	JLEZ	ERROR
9: ;prepara area dati di ePrimo
10: 	LOAD#	STACK
11: 	ADD	SS
12: 	STORE	SP ; Stack Pointer
13: 	LOAD#	PUNTORITORNO
14: 	STORE@	SP ; push indirizzo di ritorno
15: 	LOAD	SS
16: 	ADD#	1
17: 	STORE 	SS
18: 	LOAD#	STACK
19: 	ADD	SS
20: 	STORE	SP
21: 	LOAD	NUM
22: 	STORE@	SP ; push parametro
23: 	LOAD	SS
24: 	ADD#	1
25: 	STORE	SS ; SS punta al primo libero dello stack
26: 	JUMP	EPRIMO	
27: PUNTORITORNO:	
28: 	LOAD#	STACK
29: 	ADD	SS
30: 	STORE	SP
31: 	LOAD@	SP
32: 	STORE	FLAG ; pop risultato
33: 	LOAD	SS
34: 	SUB#	1
35: 	STORE	SS   ; svuota stack
36: 	WRITE	FLAG
37: 	JUMP	FINE
38: ERROR:
39: 	WRITE#	-1
40: FINE:
41: 	HALT
42: ;
43: ;segue il "metodo" ePrimo	
44: ;
45: EPRIMO:		
46: 	LOAD	SS
47: 	SUB#	1
48: 	STORE	SS
49: 	LOAD#	STACK
50: 	ADD	SS
51: 	STORE	SP ; SP punta al parametro
52: 	LOAD@	SP
53: 	STORE	X  ; pop parametro e lo salva in X
54: 	LOAD	SS
55: 	SUB#	1
56: 	STORE	SS ; "elimina" parametro
57: 	LOAD	X
58: 	SUB#	2
59: 	JNZ	PROSEGUI
60: 	LOAD#	1
61: 	STORE	FLAG
62: 	JUMP	TERMINA
63: PROSEGUI:
64: 	LOAD	X
65: 	DIV#	2
66: 	MUL#	2
67: 	SUB	X
68: 	JNZ	AVANTI
69: 	LOAD#	0
70: 	STORE	FLAG
71: 	JUMP	TERMINA
72: AVANTI:
73: ;ciclo verifica primalità di un numero dispari
74: 	LOAD#	3
75: 	STORE	POTDIV
76: 	LOAD	X
77: 	DIV#	2
78: 	STORE	LIMITE
79: 	LOAD#	1
80: 	STORE	FLAG ; ottimismo
81: CICLO:
82: 	LOAD	POTDIV
83: 	SUB	LIMITE
84: 	JGZ	TERMINA
85: 	LOAD	FLAG
86: 	JZ	TERMINA
87: 	LOAD	X
88: 	DIV	POTDIV
89: 	MUL	POTDIV
90: 	SUB	X
91: 	JNZ	CONTINUA
92: 	LOAD#	0
93: 	STORE	FLAG
94: CONTINUA:
95: 	LOAD	POTDIV
96: 	ADD#	2
97: 	STORE	POTDIV
98: 	JUMP	CICLO
99: TERMINA:
100: 	LOAD#	STACK
101: 	ADD	SS
102: 	STORE	SP
103: 	LOAD@	SP
104: 	STORE	INDRIT ; pop indirizzo di ritorno
105: 	LOAD	FLAG   ; rimpiazza indirizzo di ritorno col risultato
106: 	STORE@	SP
107: 	JUMP@	INDRIT
108: 
109: 	
110: 	

Contenuto Tabella dei Simboli
AVANTI @ 175 size: 1 tipo: ISTR
CICLO @ 196 size: 1 tipo: ISTR
CONTINUA @ 232 size: 1 tipo: ISTR
EPRIMO @ 100 size: 1 tipo: ISTR
ERROR @ 96 size: 1 tipo: ISTR
FINE @ 99 size: 1 tipo: ISTR
FLAG @ 268 size: 1 tipo: DATO
INDRIT @ 269 size: 1 tipo: DATO
LIMITE @ 270 size: 1 tipo: DATO
NUM @ 271 size: 1 tipo: DATO
POTDIV @ 272 size: 1 tipo: DATO
PROSEGUI @ 151 size: 1 tipo: ISTR
PUNTORITORNO @ 273 size: 1 tipo: DATO
SP @ 274 size: 1 tipo: DATO
SS @ 275 size: 1 tipo: DATO
STACK @ 276 size: 100 tipo: DATO
TERMINA @ 244 size: 1 tipo: ISTR
X @ 376 size: 1 tipo: DATO


Tabella codici operativi

{HALT=25, ADD=14, SUB=15, LOAD=10, MUL=16, JUMP=24, WRITE=13, READ=12, DIV=17, JZ=18, JGEZ=23, JLEZ=21, JNZ=19, STORE=11, JLZ=20, JGZ=22}

Tabella dei modi

{ =0, @=2, #=1}

Codice macchina generato

0 10
1 1
2 0
3 11
4 0
5 275
6 12
7 0
8 271
9 10
10 0
11 271
12 21
13 0
14 96
15 10
16 1
17 276
18 14
19 0
20 275
21 11
22 0
23 274
24 10
25 1
26 66
27 11
28 2
29 274
30 10
31 0
32 275
33 14
34 1
35 1
36 11
37 0
38 275
39 10
40 1
41 276
42 14
43 0
44 275
45 11
46 0
47 274
48 10
49 0
50 271
51 11
52 2
53 274
54 10
55 0
56 275
57 14
58 1
59 1
60 11
61 0
62 275
63 24
64 0
65 100
66 10
67 1
68 276
69 14
70 0
71 275
72 11
73 0
74 274
75 10
76 2
77 274
78 11
79 0
80 268
81 10
82 0
83 275
84 15
85 1
86 1
87 11
88 0
89 275
90 13
91 0
92 268
93 24
94 0
95 99
96 13
97 1
98 -1
99 25
100 10
101 0
102 275
103 15
104 1
105 1
106 11
107 0
108 275
109 10
110 1
111 276
112 14
113 0
114 275
115 11
116 0
117 274
118 10
119 2
120 274
121 11
122 0
123 376
124 10
125 0
126 275
127 15
128 1
129 1
130 11
131 0
132 275
133 10
134 0
135 376
136 15
137 1
138 2
139 19
140 0
141 151
142 10
143 1
144 1
145 11
146 0
147 268
148 24
149 0
150 244
151 10
152 0
153 376
154 17
155 1
156 2
157 16
158 1
159 2
160 15
161 0
162 376
163 19
164 0
165 175
166 10
167 1
168 0
169 11
170 0
171 268
172 24
173 0
174 244
175 10
176 1
177 3
178 11
179 0
180 272
181 10
182 0
183 376
184 17
185 1
186 2
187 11
188 0
189 270
190 10
191 1
192 1
193 11
194 0
195 268
196 10
197 0
198 272
199 15
200 0
201 270
202 22
203 0
204 244
205 10
206 0
207 268
208 18
209 0
210 244
211 10
212 0
213 376
214 17
215 0
216 272
217 16
218 0
219 272
220 15
221 0
222 376
223 19
224 0
225 232
226 10
227 1
228 0
229 11
230 0
231 268
232 10
233 0
234 272
235 14
236 1
237 2
238 11
239 0
240 272
241 24
242 0
243 196
244 10
245 1
246 276
247 14
248 0
249 275
250 11
251 0
252 274
253 10
254 2
255 274
256 11
257 0
258 269
259 10
260 0
261 268
262 11
263 2
264 274
265 24
266 2
267 269
268 0
269 0
270 0
271 0
272 0
273 0
274 0
275 0
276 0
277 0
278 0
279 0
280 0
281 0
282 0
283 0
284 0
285 0
286 0
287 0
288 0
289 0
290 0
291 0
292 0
293 0
294 0
295 0
296 0
297 0
298 0
299 0
300 0
301 0
302 0
303 0
304 0
305 0
306 0
307 0
308 0
309 0
310 0
311 0
312 0
313 0
314 0
315 0
316 0
317 0
318 0
319 0
320 0
321 0
322 0
323 0
324 0
325 0
326 0
327 0
328 0
329 0
330 0
331 0
332 0
333 0
334 0
335 0
336 0
337 0
338 0
339 0
340 0
341 0
342 0
343 0
344 0
345 0
346 0
347 0
348 0
349 0
350 0
351 0
352 0
353 0
354 0
355 0
356 0
357 0
358 0
359 0
360 0
361 0
362 0
363 0
364 0
365 0
366 0
367 0
368 0
369 0
370 0
371 0
372 0
373 0
374 0
375 0
376 0

